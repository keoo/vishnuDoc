<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>D4.1a - VISHNU Information Management Services Module Design</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.0" /></head><body><div class="book"><div class="titlepage"><div><div><h1 class="title"><a id="idm15527720"></a>D4.1a - VISHNU Information Management Services Module Design</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Benjamin</span> <span class="surname">Isnard</span></h3></div></div><div><div class="author"><h3 class="author"><span class="firstname">Daouda</span> <span class="surname">Traoré</span></h3></div></div><div><div class="author"><h3 class="author"><span class="firstname">Eugène</span> <span class="surname">Pamba Capo-Chichi</span></h3></div></div><div><div class="author"><h3 class="author"><span class="firstname">Kevin</span> <span class="surname">Coulomb</span></h3></div></div><div><div class="author"><h3 class="author"><span class="firstname">Ibrahima</span> <span class="surname">Cissé</span></h3></div></div><div><div class="revhistory"><table style="border-style:solid; width:100%;" summary="Revision History"><tr><th align="left" valign="top" colspan="3"><strong>Revision History</strong></th></tr><tr><td align="left">Revision 1</td><td align="left">06/04/2011</td><td align="left">SysFera</td></tr><tr><td align="left" colspan="3">
          
        <p>Deliverable version</p></td></tr><tr><td align="left">Revision 2</td><td align="left">16/12/2011</td><td align="left">SysFera</td></tr><tr><td align="left" colspan="3">
          
        <p>Replace all Oracle occurrences by MySQL</p></td></tr><tr><td align="left">Revision 3</td><td align="left">16/02/2012</td><td align="left">SysFera</td></tr><tr><td align="left" colspan="3">
          
        <p>New service defineAuthIdentifier</p></td></tr></table></div></div></div><hr /></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="chapter"><a href="#idp7840">1. Document presentation</a></span></dt><dd><dl><dt><span class="section"><a href="#idp8160">Document objectives</a></span></dt><dt><span class="section"><a href="#idp9272">Document structure</a></span></dt><dt><span class="section"><a href="#idp12216">References</a></span></dt><dt><span class="section"><a href="#idp15104">Acronyms</a></span></dt><dt><span class="section"><a href="#idp32864">Glossary</a></span></dt></dl></dd><dt><span class="chapter"><a href="#idp41040">2. IMS System Architecture</a></span></dt><dd><dl><dt><span class="section"><a href="#idp41392">IMS software Components</a></span></dt><dd><dl><dt><span class="section"><a href="#idp49256">IMS client-side components</a></span></dt><dt><span class="section"><a href="#idp51440">IMS server-side components</a></span></dt></dl></dd><dt><span class="section"><a href="#idp53640">IMS package dependencies</a></span></dt><dd><dl><dt><span class="section"><a href="#idp54400">IMS Client - required packages</a></span></dt><dt><span class="section"><a href="#idp61560">IMS Server - required packages</a></span></dt></dl></dd><dt><span class="section"><a href="#idp67128">IMS Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#idp72768">IMS deployment overview</a></span></dt><dt><span class="section"><a href="#idp75488">IMS deployment diagram</a></span></dt><dt><span class="section"><a href="#idp77736">SysFera-DS Bus Details</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp80760">3. Overview of the IMS modelization</a></span></dt><dd><dl><dt><span class="section"><a href="#idp81120">Functional view</a></span></dt><dt><span class="section"><a href="#idp86960">Role description</a></span></dt><dt><span class="section"><a href="#idp92464">Classes and roles</a></span></dt></dl></dd><dt><span class="chapter"><a href="#idp95048">4. Internal API specification</a></span></dt><dd><dl><dt><span class="section"><a href="#idp95568">Generic definition formats presentation</a></span></dt><dd><dl><dt><span class="section"><a href="#idp96256">Service definition format</a></span></dt></dl></dd><dt><span class="section"><a href="#idp110424">Definition of the services of the package</a></span></dt><dd><dl><dt><span class="section"><a href="#idp110792">Service int_exportCommands</a></span></dt><dt><span class="section"><a href="#idp130848">Service int_getMetricCurrentValue</a></span></dt><dt><span class="section"><a href="#idp150960">Service int_getMetricHistory</a></span></dt><dt><span class="section"><a href="#idp171112">Service int_getProcesses</a></span></dt><dt><span class="section"><a href="#idp186664">Service int_setSystemInfo</a></span></dt><dt><span class="section"><a href="#idp201184">Service int_setSystemThreshold</a></span></dt><dt><span class="section"><a href="#idp215696">Service int_getSystemThreshold</a></span></dt><dt><span class="section"><a href="#idp231968">Service int_defineUserIdentifier</a></span></dt><dt><span class="section"><a href="#idp246288">Service int_defineMachineIdentifier</a></span></dt><dt><span class="section"><a href="#idp260624">Service int_defineJobIdentifier</a></span></dt><dt><span class="section"><a href="#idp274944">Service int_defineTransferIdentifier</a></span></dt><dt><span class="section"><a href="#idp289296">Service int_defineAuthIdentifier</a></span></dt><dt><span class="section"><a href="#idp303632">Service int_loadShed</a></span></dt><dt><span class="section"><a href="#idp320544">Service int_setUpdateFrequency</a></span></dt><dt><span class="section"><a href="#idp334832">Service int_getUpdateFrequency</a></span></dt><dt><span class="section"><a href="#idp351448">Service int_restart</a></span></dt><dt><span class="section"><a href="#idp369328">Service int_stop</a></span></dt><dt><span class="section"><a href="#idp383752">Service int_getSystemInfo</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#idp402408">5. Internal class and data structures</a></span></dt><dd><dl><dt><span class="section"><a href="#idp402768">Introduction</a></span></dt><dt><span class="section"><a href="#idp407528">IMS Proxy ClassDiagram</a></span></dt><dt><span class="section"><a href="#idp409568">IMS Server ClassDiagram</a></span></dt><dt><span class="section"><a href="#idp411608">IMS Datatype ClassDiagram</a></span></dt></dl></dd></dl></div><div class="list-of-figures"><p><strong>List of Figures</strong></p><dl><dt>2.1. <a href="#idp50000">IMS client-side components</a></dt><dt>2.2. <a href="#idp52160">IMS server-side components</a></dt><dt>2.3. <a href="#idp74072">IMS deployment overview</a></dt><dt>2.4. <a href="#idp76320">IMS deployment diagram</a></dt><dt>2.5. <a href="#idp79216">SysFera-DS Bus Details</a></dt><dt>3.1. <a href="#idp81928">Functional roles</a></dt><dt>3.2. <a href="#idp93576">Classes implementing the roles</a></dt><dt>5.1. <a href="#idp408152">IMS Proxy ClassDiagram</a></dt><dt>5.2. <a href="#idp410192">IMS Server ClassDiagram</a></dt><dt>5.3. <a href="#idp412224">IMS Datatype ClassDiagram</a></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp7840"></a>Chapter 1. Document presentation</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#idp8160">Document objectives</a></span></dt><dt><span class="section"><a href="#idp9272">Document structure</a></span></dt><dt><span class="section"><a href="#idp12216">References</a></span></dt><dt><span class="section"><a href="#idp15104">Acronyms</a></span></dt><dt><span class="section"><a href="#idp32864">Glossary</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp8160"></a>Document objectives</h2></div></div></div><p>
	This document presents the detailed internal design of the Information Management Services (IMS) module. The purpose
	of this module is to handle all aspects of information management within the VISHNU system. The functional and
	non-functional requirements for this module are those described in the referenced specification documents. The current
	document is part of the design phase of the software and therefore its main goal is to define the main components of the
	system architecture and their relationships.
      </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp9272"></a>Document structure</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Chapter 1 contains a brief overview of the document's content.</p></li><li class="listitem"><p>Chapter 2 contains a description of the IMS module's architecture.</p></li><li class="listitem"><p>Chapter 3 contains an overview of the IMS module's modelization.</p></li><li class="listitem"><p>Chapter 4 describes the internal API used for remote procedure calls through SysFera-DS.</p></li><li class="listitem"><p>Chapter 5 describes the internal classes and data structures</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp12216"></a>References</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>[D1.1a]: VISHNU General specifications</p></li><li class="listitem"><p>[D1.1b]: VISHNU Spécifications techniques des besoins</p></li><li class="listitem"><p>[D1.1c]: VISHNU API Detailed specifications</p></li><li class="listitem"><p>[D1.1g]: VISHNU Technical architecture</p></li><li class="listitem"><p>[D1.1g-DAT]: VISHNU Dossier d'Architecture Technique</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp15104"></a>Acronyms</h2></div></div></div><p>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>API</strong></span>: Application Programming Interface</p></li><li class="listitem"><p><span class="bold"><strong>CLI</strong></span>: Command Line Interface</p></li><li class="listitem"><p><span class="bold"><strong>DB</strong></span>: Database</p></li><li class="listitem"><p><span class="bold"><strong>n/a</strong></span>: Not Applicable</p></li><li class="listitem"><p><span class="bold"><strong>IMS</strong></span>: Information Management Services</p></li><li class="listitem"><p><span class="bold"><strong>WS</strong></span>: Web Services</p></li></ul></div><p>
      </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp32864"></a>Glossary</h2></div></div></div><p>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>Components</strong></span>: the software components represents a library or an executable program that provides a given interface to other components or to end-users.</p></li><li class="listitem"><p><span class="bold"><strong>DIET</strong></span>: component of the SysFera-DS solution that provides the communication layer between the agents that are part of the VISHNU infrastructure.</p></li><li class="listitem"><p><span class="bold"><strong>GoDIET</strong></span>: component of the SysFera-DS solution that provides a launcher for all the processes of the VISHNU infrastructure.</p></li><li class="listitem"><p><span class="bold"><strong>LogCentral</strong></span>: component of the SysFera-DS solution that provides event notifications within a SysFera-DS platform.</p></li><li class="listitem"><p><span class="bold"><strong>MasterAgent</strong></span>: DIET process, linking the client and the server</p></li><li class="listitem"><p><span class="bold"><strong>omniNames</strong></span>: CORBA process, needed by DIET</p></li><li class="listitem"><p><span class="bold"><strong>SeD</strong></span>: A Server Daemon, a SysFera-DS agent that provides services through the SysFera-DS API.</p></li><li class="listitem"><p><span class="bold"><strong>Serialized type</strong></span>: class of data (C++ Class) whose instances can be serialized in a XML string before being sent over a communication channel (CORBA for example).</p></li><li class="listitem"><p><span class="bold"><strong>SysFera-DS</strong></span>: open-source middleware developped by SysFera.</p></li><li class="listitem"><p><span class="bold"><strong>VISHNU Process</strong></span>: process, running permanently, that provides VISHNU services. This is a sub-class of SeD.</p></li></ul></div><p>
      </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp41040"></a>Chapter 2. IMS System Architecture</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#idp41392">IMS software Components</a></span></dt><dd><dl><dt><span class="section"><a href="#idp49256">IMS client-side components</a></span></dt><dt><span class="section"><a href="#idp51440">IMS server-side components</a></span></dt></dl></dd><dt><span class="section"><a href="#idp53640">IMS package dependencies</a></span></dt><dd><dl><dt><span class="section"><a href="#idp54400">IMS Client - required packages</a></span></dt><dt><span class="section"><a href="#idp61560">IMS Server - required packages</a></span></dt></dl></dd><dt><span class="section"><a href="#idp67128">IMS Deployment</a></span></dt><dd><dl><dt><span class="section"><a href="#idp72768">IMS deployment overview</a></span></dt><dt><span class="section"><a href="#idp75488">IMS deployment diagram</a></span></dt><dt><span class="section"><a href="#idp77736">SysFera-DS Bus Details</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp41392"></a>IMS software Components</h2></div></div></div><p>In this section, we present a description of the IMS module's software components.
	In addition we detail the dependencies between the components to show how to reuse them. These components follow a client/server model.
        We present the different software layers, from services (provided directly to the user) to the database (used by the server). 
	The IMS client and server packages have been split into seven different interrelated components. The diagrams shown in sections 2.1.1
        and 2.1.2 describe the relationships between these components. The definitions of the components are as follows:
       </p><p>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>the <span class="bold"><strong>External API</strong></span>
	     contains the services provided to the user, as defined in the detailed specifications.
	     It is used client-side.
	    </p></li><li class="listitem"><p>the <span class="bold"><strong>Internal API</strong></span>
	     is the server-side interface used by the IMS Client components. It provides a set of services that are remotely accessible
             through the SysFera-DS middleware. This layer does not contain any business logic and uses the IMS SeD to implement the service.
	    </p></li><li class="listitem"><p>the <span class="bold"><strong>IMS Client</strong></span>
	    contains intermediate (proxy) classes providing remote access to the business objects of the <span class="bold"><strong>IMS SeD</strong></span>.
	    </p></li><li class="listitem"><p>the <span class="bold"><strong>IMS Server</strong></span>
	     provides the business logic of the IMS module on the server's side. The set of classes in this component cover all the IMS objects
             that have a proxy class that publishes services to the external API, in addition to some classes that provide the IMS module's internal mechanisms.
	    </p></li><li class="listitem"><p>the <span class="bold"><strong>Sysfera-DS Client API</strong></span> is the C++ client API provided by the SysFera-DS toolbox.</p></li><li class="listitem"><p>the <span class="bold"><strong>Sysfera-DS Server API</strong></span> is the C++ server API provided by the SysFera-DS toolbox.</p></li><li class="listitem"><p>the <span class="bold"><strong>VISHNU Database</strong></span> stores all data handled by the IMS SeD.
	    </p></li></ul></div><p>
      </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp49256"></a>IMS client-side components</h3></div></div></div><p>This diagram shows the components that compose the client side of the VISHNU IMS system and their interfaces. All the interfaces of the IMS Client component are shown (CLI, WS, python, C++).</p><div class="figure"><a id="idp50000"></a><p class="title"><strong>Figure 2.1. IMS client-side components</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS_client-side_components.png" align="middle" alt="IMS client-side components" /></div></div></div><br class="figure-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp51440"></a>IMS server-side components</h3></div></div></div><p>This diagram shows the components that compose the server side of the VISHNU IMS system and their interfaces. All the interfaces of the IMS SeD component are shown.</p><div class="figure"><a id="idp52160"></a><p class="title"><strong>Figure 2.2. IMS server-side components</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS_server-side_components.png" align="middle" alt="IMS server-side components" /></div></div></div><br class="figure-break" /></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp53640"></a>IMS package dependencies</h2></div></div></div><p>In order to install the IMS service on the infrastructure, some packages are required. The following tables list all the packages that must be
        installed on the IMS client and on the IMS server hosts:</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp54400"></a>IMS Client - required packages</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Package Name</th><th>Description</th></tr></thead><tbody><tr><td><p>SysFera-DS/DIET</p></td><td><p>Middleware</p></td></tr><tr><td><p>VISHNU UMS client</p></td><td><p>VISHNU Client Package for user and session management</p></td></tr><tr><td><p>VISHNU TMS client</p></td><td><p>VISHNU Client Package for task management</p></td></tr><tr><td><p>VISHNU FMS client</p></td><td><p>VISHNU Client Package for file management</p></td></tr><tr><td><p>Python (optional)</p></td><td><p>Python language, required to use the VISHNU Python API</p></td></tr><tr><td><p>Java 1.6 (optional)</p></td><td><p>Java environment, required to use the VISHNU WS API</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp61560"></a>IMS Server - required packages</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Package Name</th><th>Description</th></tr></thead><tbody><tr><td><p>SysFera-DS/DIET</p></td><td><p>Middleware</p></td></tr><tr><td><p>SysFera-DS/LogService</p></td><td><p>Middleware component for monitoring</p></td></tr><tr><td><p>VISHNU UMS</p></td><td><p>VISHNU Package for user and session management</p></td></tr><tr><td><p>PostgreSQL client (or MySQL client)</p></td><td><p>Database client</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp67128"></a>IMS Deployment</h2></div></div></div><p>
        This section explains how the VISHNU IMS module will be deployed on a physical infrastructure, as illustrated in figures 2.3 and 2.4.
        Each box in the figures represents an operating system in which a component or a set of components are running as processes.
        For an overview of all the components of the VISHNU infrastructure, please refer to document [D1.1g].
        The IMS module components are: 
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>IMS SeD</strong></span>, the process that provides all IMS internal services.
            This process is required on any host of the VISHNU infrastructure where VISHNU processes have to be monitored. Without an IMS process running on the 
            host, IMS services (e.g., restart processes, get system information, do load shedding) will not be available on that host.</p></li><li class="listitem"><p><span class="bold"><strong>Client host</strong></span>, the host used by the user to launch IMS requests through one of the VISHNU user interfaces.
            It contains all the client components required to make an IMS service request.
	    </p></li><li class="listitem"><p><span class="bold"><strong>LogCentral</strong></span>, a SysFera-DS process that is necessary to monitor the DIET platform. This process is part of DIET
	      in the SysFera-DS package. It can be deployed on any host that can connect to the omniNames and to the DIET MasterAgent using CORBA.
              To simplify the deployment, it can be run on the same machine as these processes.
            </p></li><li class="listitem"><p><span class="bold"><strong>SysFera-DS Bus </strong></span>, the specific software layer that ensures the communication between client hosts and server hosts.
            </p></li><li class="listitem"><p><span class="bold"><strong>VISHNU database</strong></span>, this component represents a unique instance of an MySQL or PostgreSQL database.
            </p></li></ul></div><p>
       </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp72768"></a>IMS deployment overview</h3></div></div></div><p>The following diagram shows an example of the VISHNU infrastructure with one instance of FMS Server and one instance
          of TMS Server. All components of the infrastructure are shown including the SysFera-DS processes, the JBoss web server used
          to deploy the web services API, and the database server. The VISHNU Admin system hosts the SysFera-DS/GoDIET
          application that is used to launch all processes of the VISHNU infrastructure using ssh connections (red arrows). The
          SysFera-DS LogCentral process is used to publish events when VISHNU elements are connected to or disconnected from the
          VISHNU infrastructure. These events are sent to VISHNU IMS Servers that are subscribers to the LogCentral event flow.</p><div class="figure"><a id="idp74072"></a><p class="title"><strong>Figure 2.3. IMS deployment overview</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS Deployment Overview.png" align="middle" alt="IMS deployment overview" /></div></div></div><br class="figure-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp75488"></a>IMS deployment diagram</h3></div></div></div><p>This diagram shows the generic deployment pattern of VISHNU processes.
          All IMS SeD processes must connect to the same VISHNU database.
          The TMS and FMS SeD are optional; if present, they can be used to fulfill some IMS services (e.g. load shedding).
        </p><div class="figure"><a id="idp76320"></a><p class="title"><strong>Figure 2.4. IMS deployment diagram</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS_Deployment_Diagram.png" align="middle" alt="IMS deployment diagram" /></div></div></div><br class="figure-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp77736"></a>SysFera-DS Bus Details</h3></div></div></div><p>This diagram shows the communication paths between the Client host and an IMS SeD using the SysFera-DS Bus.
          The SysFera-DS MasterAgent is a SysFera-DS agent that can be executed on a dedicated host or on the same host as the IMS SeD.
          All the communications between the entities here are done using the CORBA IIOP (Internet Inter-ORB) protocol and
          the communications can be tunneled through SSH tunnels if necessary. The MasterAgent entity is involved in the choice
          of one IMS SeD in the case of several available IMS SeD. The choice will be transparent to the user as all
          IMS SeD connect to the same database.
          The IMS client can be client of the FMS or TMS SeD so they are presented on the diagram. 
          However, this call may only happen if a specific call to the load-shedding service is made on the machine 
          where the FMS and/or TMS SeD are running.</p><div class="figure"><a id="idp79216"></a><p class="title"><strong>Figure 2.5. SysFera-DS Bus Details</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/SysFera-DS_Bus_Details.png" align="middle" alt="SysFera-DS Bus Details" /></div></div></div><br class="figure-break" /></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp80760"></a>Chapter 3. Overview of the IMS modelization</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#idp81120">Functional view</a></span></dt><dt><span class="section"><a href="#idp86960">Role description</a></span></dt><dt><span class="section"><a href="#idp92464">Classes and roles</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp81120"></a>Functional view</h2></div></div></div><p>The following diagram is functional. The IMS client can ask the IMS SeD to fill four functions. It is important to note that the IMS client can access specific TMS and FMS services. Morevover, all the SeD will have to save the command that was used to launch them.</p><div class="figure"><a id="idp81928"></a><p class="title"><strong>Figure 3.1. Functional roles</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/role.png" align="middle" alt="Functional roles" /></div></div></div><br class="figure-break" /><p>
	Meaning of the roles presented in the diagram:
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A: The external API corresponds to the functionalities that called by the IMS client</p></li><li class="listitem"><p>B: The function of HistoryMaker is to get the state of the machine and to automatically save it in the database. The admin is then notified if the state has reached a threshold for the machine.</p></li><li class="listitem"><p>C: LogTool corresponds to the part of the SeD that will be linked to LogCentral, following the publisher/subscriber model. It receives information when a SeD connects to or disconnects from the machine on which the IMS SeD is running.</p></li><li class="listitem"><p>D: ProcessManager is responsible for relaunching a dead SeD, stopping a SeD or making the load shedding.</p></li><li class="listitem"><p>E: new functionalities must be added to the TMS/FMS client to allow sending commands to the TMS/FMS SeD.</p></li><li class="listitem"><p>F: modification of the SeD to hava them save their parameters when launched, it enables to restart the SeD with the same parameters.</p></li></ul></div><p>
      </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp86960"></a>Role description</h2></div></div></div><p>
	The IMS module can play eight different roles. For each role, there is a reference to the above functional figure with the letter corresponding to the functional element.
	</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Hard load shedding: all the VISHNU processes on a machine are killed. These processes will not be automatically relauched. Only the GoDiet tool can relaunch them. Reference: D.</p></li><li class="listitem"><p>The soft load shedding: the current jobs (submitted using TMS) and file transfers (made with FMS) on a machine are ended. The stopped commands are flagged as failed, in the database. Reference: E+D</p></li><li class="listitem"><p>Export of the commands in a given format: it generates a shell script containing all commands executed during a session. Commands such as connect or change password cannot be exported: because the server does not know the user's password, the script cannot be executed automatically, so a connect call must be added. Reference: A</p></li><li class="listitem"><p>Live monitoring: getting the current state of the machines. Reference: A</p></li><li class="listitem"><p>Delayed monitor: getting past states of a machine and automatically recording the states of the machine as time passes. Reference: A + B</p></li><li class="listitem"><p>Notification during monitoring: automatically notifying the administrator about an abnormal behaviour of the VISHNU system. Reference: B</p></li><li class="listitem"><p>Automatic restart: Once a SeD is down, the IMS SeD is informed and tries to relaunch it. If an agent is down, it cannot be restarted by the IMS SeD; GoDIET will do it. Reference: A + C</p></li><li class="listitem"><p>Manual restart: can be made using GoDIET, but it is also available throught the IMS API. Only a VISHNU SeD can be relaunched throught the API. Reference: F + D</p></li></ul></div><p>
      </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp92464"></a>Classes and roles</h2></div></div></div><p>The following figure presents the links between the functional roles and corresponding classes. There are two main groups of classes. The DATA classes, that correspond to the external API and deal with the database, and the CONTROLER classes that only interact with the DATA classes</p><div class="figure"><a id="idp93576"></a><p class="title"><strong>Figure 3.2. Classes implementing the roles</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/classes.png" align="middle" alt="Classes implementing the roles" /></div></div></div><br class="figure-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp95048"></a>Chapter 4. Internal API specification</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#idp95568">Generic definition formats presentation</a></span></dt><dd><dl><dt><span class="section"><a href="#idp96256">Service definition format</a></span></dt></dl></dd><dt><span class="section"><a href="#idp110424">Definition of the services of the package</a></span></dt><dd><dl><dt><span class="section"><a href="#idp110792">Service int_exportCommands</a></span></dt><dt><span class="section"><a href="#idp130848">Service int_getMetricCurrentValue</a></span></dt><dt><span class="section"><a href="#idp150960">Service int_getMetricHistory</a></span></dt><dt><span class="section"><a href="#idp171112">Service int_getProcesses</a></span></dt><dt><span class="section"><a href="#idp186664">Service int_setSystemInfo</a></span></dt><dt><span class="section"><a href="#idp201184">Service int_setSystemThreshold</a></span></dt><dt><span class="section"><a href="#idp215696">Service int_getSystemThreshold</a></span></dt><dt><span class="section"><a href="#idp231968">Service int_defineUserIdentifier</a></span></dt><dt><span class="section"><a href="#idp246288">Service int_defineMachineIdentifier</a></span></dt><dt><span class="section"><a href="#idp260624">Service int_defineJobIdentifier</a></span></dt><dt><span class="section"><a href="#idp274944">Service int_defineTransferIdentifier</a></span></dt><dt><span class="section"><a href="#idp289296">Service int_defineAuthIdentifier</a></span></dt><dt><span class="section"><a href="#idp303632">Service int_loadShed</a></span></dt><dt><span class="section"><a href="#idp320544">Service int_setUpdateFrequency</a></span></dt><dt><span class="section"><a href="#idp334832">Service int_getUpdateFrequency</a></span></dt><dt><span class="section"><a href="#idp351448">Service int_restart</a></span></dt><dt><span class="section"><a href="#idp369328">Service int_stop</a></span></dt><dt><span class="section"><a href="#idp383752">Service int_getSystemInfo</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp95568"></a>Generic definition formats presentation</h2></div></div></div><p>This section presents the formats used in this chapter to describe the services provided
            by the internal API.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp96256"></a>Service definition format</h3></div></div></div><p><span class="bold"><strong>Access </strong></span></p><p>Here is detailed the access level of the service 'myService' (i.e. the privilege required to use it)</p><p><span class="bold"><strong>Parameters</strong></span></p><p>The following table contains all the input and output parameters of the service, along with their type and description.</p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>This is an example of a required string input parameter</p></td><td><p>IN</p></td></tr><tr><td><p>listOfJobs</p></td><td><p>string</p></td><td><p>ListJobs</p></td><td><p>This is an example of an object output parameter that is serialized as a string</p></td><td><p>OUT</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>Here is detailed the purpose of the service 'myService'</p><p><span class="bold"><strong>Return Value </strong></span></p><p>Here are detailed the different return codes provided by the service.</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>The service has been performed successfully.</p></td></tr><tr><td><p>TMS_UNKNOWN_MACHINE</p></td><td><p>This is the human-readable generic message that will be available to the user of the API.</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>This shows the list of functions from the external Vishnu API (see [D1_1c]) that use this service.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp110424"></a>Definition of the services of the package</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp110792"></a>Service int_exportCommands</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by any VISHNU user</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>oldSessionId</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The id of the session to export (session has ended)</p></td><td><p>IN</p></td></tr><tr><td><p>filename</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The path of the output file containing the Vishnu shell commands</p></td><td><p>INOUT</p></td></tr><tr><td><p>options</p></td><td><p>string</p></td><td><p><a class="link" href="#">ExportOp</a></p></td><td><p>Options for the export</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_exportCommands() function exports all the commands made by a user during a session</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_UNDEFINED</p></td><td><p>Undefined error code</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_EXPIRED</p></td><td><p>The session key has expired. The session is closed.</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_NOT_FOUND</p></td><td><p>The session key is unrecognized.</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::exportCommands</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp130848"></a>Service int_getMetricCurrentValue</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by any VISHNU user</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>machineId</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The id of the machine</p></td><td><p>IN</p></td></tr><tr><td><p>metricValue</p></td><td><p>string</p></td><td><p><a class="link" href="#">ListMetric</a></p></td><td><p>Value of the metric</p></td><td><p>OUT</p></td></tr><tr><td><p>options</p></td><td><p>string</p></td><td><p><a class="link" href="#">CurMetricOp</a></p></td><td><p>Options</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_getMetricCurrentValue() function retrieve the current value of a metric on a machine</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_EXPIRED</p></td><td><p>The session key has expired. The session is closed.</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_NOT_FOUND</p></td><td><p>The session key is unrecognized.</p></td></tr><tr><td><p>ERRCODE_UNDEFINED</p></td><td><p>Undefined error code</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::getMetricCurrentValue</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp150960"></a>Service int_getMetricHistory</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by any VISHNU user</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>machineId</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The id of the machine</p></td><td><p>IN</p></td></tr><tr><td><p>metricValues</p></td><td><p>string</p></td><td><p><a class="link" href="#">ListMetric</a></p></td><td><p>List of metric values</p></td><td><p>OUT</p></td></tr><tr><td><p>endTime</p></td><td><p>string</p></td><td><p><a class="link" href="#">MetricHistOp</a></p></td><td><p>End time of metric history</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_getMetricHistory() function retrieve the history of values of a metric on a machine</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_EXPIRED</p></td><td><p>The session key has expired. The session is closed.</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_NOT_FOUND</p></td><td><p>The session key is unrecognized.</p></td></tr><tr><td><p>ERRCODE_UNDEFINED</p></td><td><p>Undefined error code</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::getMetricHistory</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp171112"></a>Service int_getProcesses</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>process</p></td><td><p>string</p></td><td><p><a class="link" href="#">ListProcesses</a></p></td><td><p>The list of the Vishnu processes on the machine</p></td><td><p>OUT</p></td></tr><tr><td><p>options</p></td><td><p>string</p></td><td><p><a class="link" href="#">ProcessOp</a></p></td><td><p>The id of the machine the user wants the running processes</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_getProcesses() function gets the list of the processes running over a front machine</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::getProcesses</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp186664"></a>Service int_setSystemInfo</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>systemInfo</p></td><td><p>string</p></td><td><p><a class="link" href="#">SystemInfo</a></p></td><td><p>Contains system information to store in Vishnu database</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_setSystemInfo() function updates the system information of a machine</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::setSystemInfo</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp201184"></a>Service int_setSystemThreshold</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>threshold</p></td><td><p>string</p></td><td><p><a class="link" href="#">Threshold</a></p></td><td><p>The type of the metric to set</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_setSystemThreshold() function sets a threshold on a machine of a system</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::setSystemThreshold</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp215696"></a>Service int_getSystemThreshold</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>options</p></td><td><p>string</p></td><td><p><a class="link" href="#">ThresholdOp</a></p></td><td><p>The options for the threshold</p></td><td><p>IN</p></td></tr><tr><td><p>value</p></td><td><p>string</p></td><td><p><a class="link" href="#">ListThreshold</a></p></td><td><p>The threshold values</p></td><td><p>OUT</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_getSystemThreshold() function gets a System threshold on a machine</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::getSystemThreshold</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp231968"></a>Service int_defineUserIdentifier</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>format</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The new format to use</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_defineUserIdentifier() function defines the shape of the identifiers automatically generated for the users</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::defineUserIdentifier</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp246288"></a>Service int_defineMachineIdentifier</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>format</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The new format to use</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_defineMachineIdentifier() function defines the shape of the identifiers automatically generated for the machines</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::defineMachineIdentifier</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp260624"></a>Service int_defineJobIdentifier</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>format</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The new format to use</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_defineJobIdentifier() function defines the shape of the identifiers automatically generated for the jobs</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::defineJobIdentifier</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp274944"></a>Service int_defineTransferIdentifier</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>format</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The new format to use</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_defineTransferIdentifier() function defines the shape of the identifiers automatically generated for the file transfers</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::defineTransferIdentifier</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp289296"></a>Service int_defineAuthIdentifier</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>format</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The new format to use</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_defineAuthIdentifier() function defines the shape of the identifiers automatically generated for the authentication systems</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::defineAuthIdentifier</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp303632"></a>Service int_loadShed</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>machineId</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The id of the machine to stop</p></td><td><p>IN</p></td></tr><tr><td><p>loadShedType</p></td><td><p>string</p></td><td><p><a class="link" href="#">LoadShedType</a></p></td><td><p>Selects a load shedding mode (SOFT: stops all services and they can be restarted, HARD: stops all services, they cannot be restarted)</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_loadShed() function load sheds a machine</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_COMPONENT_ERROR</p></td><td><p>If a component is unavailable</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::loadShed</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp320544"></a>Service int_setUpdateFrequency</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>freq</p></td><td><p>int</p></td><td><p>n/a</p></td><td><p>Frequency the data are updated, in second</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_setUpdateFrequency() function sets the update frequency of the IMS tables</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::setUpdateFrequency</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp334832"></a>Service int_getUpdateFrequency</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by any VISHNU user</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>freq</p></td><td><p>int</p></td><td><p>n/a</p></td><td><p>Frequency the data are updated, in second</p></td><td><p>OUT</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_getUpdateFrequency() function gets the update frequency of the IMS database</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_EXPIRED</p></td><td><p>The session key has expired. The session is closed.</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_NOT_FOUND</p></td><td><p>The session key is unrecognized.</p></td></tr><tr><td><p>ERRCODE_UNDEFINED</p></td><td><p>Undefined error code</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::getUpdateFrequency</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp351448"></a>Service int_restart</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>machineId</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The id of the machine where the component is to be relaunched</p></td><td><p>IN</p></td></tr><tr><td><p>type</p></td><td><p>string</p></td><td><p><a class="link" href="#">RestartType</a></p></td><td><p>The type of restart</p></td><td><p>IN</p></td></tr><tr><td><p>options</p></td><td><p>string</p></td><td><p><a class="link" href="#">RestartOp</a></p></td><td><p>The options to restart</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_restart() function restarts the whole VISHNU infrastructure. Actions are saved and restarted from the beginning once the infrastructure has been restarted</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::restart</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp369328"></a>Service int_stop</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by ADMIN users only</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>process</p></td><td><p>string</p></td><td><p><a class="link" href="#">Process</a></p></td><td><p>The process to stop</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_stop() function to stop a sed</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::stop</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp383752"></a>Service int_getSystemInfo</h3></div></div></div><p><span class="bold"><strong>Access</strong></span></p><p>This service can be used by any VISHNU user</p><p><span class="bold"><strong>Parameters</strong></span></p><div class="informaltable"><table border="1"><colgroup><col width="2cm" /><col width="2cm" /><col width="3cm" /><col width="8cm" /><col width="1cm" /></colgroup><thead><tr><th>Parameter</th><th>Type</th><th>Serialized type</th><th>Description</th><th>Mode</th></tr></thead><tbody><tr><td><p>sessionKey</p></td><td><p>string</p></td><td><p>n/a</p></td><td><p>The session key</p></td><td><p>IN</p></td></tr><tr><td><p>res</p></td><td><p>string</p></td><td><p><a class="link" href="#">ListSysInfo</a></p></td><td><p>The set of system information</p></td><td><p>OUT</p></td></tr><tr><td><p>options</p></td><td><p>string</p></td><td><p><a class="link" href="#">SysInfoOp</a></p></td><td><p>Options for the sysinfo</p></td><td><p>IN</p></td></tr></tbody></table></div><p><span class="bold"><strong>Description </strong></span></p><p>The int_getSystemInfo() function to get system info</p><p><span class="bold"><strong>Return Value </strong></span></p><p>An error code is returned when an error occurs during the execution of the service</p><div class="informaltable"><table border="1"><colgroup><col width="8.5cm" /><col width="9cm" /></colgroup><thead><tr><th>Name
</th><th>Description
</th></tr></thead><tbody><tr><td><p>ERRCODE_DBERR</p></td><td><p>The database generated an error</p></td></tr><tr><td><p>ERRCODE_INVALID_PARAMETER</p></td><td><p>If a parameter is invalid</p></td></tr><tr><td><p>VISHNU_OK</p></td><td><p>Error code returned if success</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_EXPIRED</p></td><td><p>The session key has expired. The session is closed.</p></td></tr><tr><td><p>ERRCODE_SESSIONKEY_NOT_FOUND</p></td><td><p>The session key is unrecognized.</p></td></tr><tr><td><p>ERRCODE_UNDEFINED</p></td><td><p>Undefined error code</p></td></tr></tbody></table></div><p><span class="bold"><strong>Used by this(these) API function(s): </strong></span></p><p>IMS::getSystemInfo</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp402408"></a>Chapter 5. Internal class and data structures</h1></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="#idp402768">Introduction</a></span></dt><dt><span class="section"><a href="#idp407528">IMS Proxy ClassDiagram</a></span></dt><dt><span class="section"><a href="#idp409568">IMS Server ClassDiagram</a></span></dt><dt><span class="section"><a href="#idp411608">IMS Datatype ClassDiagram</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp402768"></a>Introduction</h2></div></div></div><p>This chapter introduces the implementation of the different components described in chapter 2.
        It is composed of three sections:
      </p><p>
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>Client modelization</strong></span>: describes the classes used to implement the 
              <span class="it">IMS Client</span> component.</p></li><li class="listitem"><p><span class="bold"><strong>Server modelization</strong></span>: describes the classes used to implement the 
              <span class="it">IMS SeD</span> component.</p></li><li class="listitem"><p><span class="bold"><strong>Data modelization</strong></span>: describes the data structure used to implement the 
              <span class="it">IMS Client</span> component and the <span class="it">IMS SeD</span> component.</p></li></ul></div><p>
      </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp407528"></a>IMS Proxy ClassDiagram</h2></div></div></div><p>The following figure presents the class diagram on the client's side</p><div class="figure"><a id="idp408152"></a><p class="title"><strong>Figure 5.1. IMS Proxy ClassDiagram</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS_Proxy_ClassDiagram.png" align="middle" alt="IMS Proxy ClassDiagram" /></div></div></div><br class="figure-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp409568"></a>IMS Server ClassDiagram</h2></div></div></div><p>The following figure presents the class diagram on the server's side</p><div class="figure"><a id="idp410192"></a><p class="title"><strong>Figure 5.2. IMS Server ClassDiagram</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS_Server_ClassDiagram.png" align="middle" alt="IMS Server ClassDiagram" /></div></div></div><br class="figure-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp411608"></a>IMS Datatype ClassDiagram</h2></div></div></div><p>The following figure presents the links between the datatypes.</p><div class="figure"><a id="idp412224"></a><p class="title"><strong>Figure 5.3. IMS Datatype ClassDiagram</strong></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="images/png/IMS_Datatype_ClassDiagram.png" align="middle" alt="IMS Datatype ClassDiagram" /></div></div></div><br class="figure-break" /></div></div></div></body></html>
